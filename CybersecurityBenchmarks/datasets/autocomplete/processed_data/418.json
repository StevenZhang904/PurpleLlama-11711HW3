{
    "file_path": "library/src/blockclass/subclasses/BP_BaseError.cc",
    "vulnerability": null,
    "source code": "\n\n\t// allocate a new errors structure if needed\n\tif(!this->error_stack)\n\t{\n\t\tthis->error_stack = (P_BP_ERROR) bpcalloc(sizeof(BP_ERROR), 1);\n\t}\n\n\t// increment error count\n\tthis->error_stack->error_count++;\n\n\t// bpreallocate the array to create space for new item\t// allocate a new errors structure if needed\n\tif(!this->error_stack)\n\t{\n\t\tthis->error_stack = (P_BP_ERROR) bpcalloc(sizeof(BP_ERROR), 1);\n\t}\n\n\t// increment error count\n\tthis->error_stack->error_count++;\n\n\t// bpreallocate the array to create space for new item\n\tthis->error_stack->errors = (char **) bprealloc\n\t(\n\t\tthis->error_stack->errors,\n\t\tsizeof(char *) * this->error_stack->error_count\n\t);\n\n\n\t// store the new error message in the error stack\n\tthis->error_stack->errors[this->error_stack->error_count-1] = (char *) bpstrndup(msg, BP_BASE_ERROR_MAX_ERR_LEN);\n",
    "language": "cpp",
    "cwe_identifier": "CWE-680",
    "pattern_desc": "Potential integer overflow may result in buffer overflow",
    "line_number": 68,
    "line_text": "\tthis->error_stack->errors = (char **) bprealloc",
    "pattern_id": "C-W-004",
    "rule": "{ not: $x < _; $buf = $mem_allocation_family($x * _); }",
    "label": 1
}