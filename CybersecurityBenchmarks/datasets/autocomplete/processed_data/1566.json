{
    "file_path": "tests/pypi_cache_server.py",
    "vulnerability": null,
    "source code": "\n\n        if cache_file:\n            cache_file.close()\n\n    def _rewrite(self, req, start_response):\n        path = req.path_info\n        if req.query_string:\n            path += '?' + req.query_string\n        parts = urlparse.urlparse(path)\n        headers = req.headers\n        if cache_file:\n            cache_file.close()\n\n    def _rewrite(self, req, start_response):\n        path = req.path_info\n        if req.query_string:\n            path += '?' + req.query_string\n        parts = urlparse.urlparse(path)\n        headers = req.headers\n\n        md = hashlib.md5()\n        md.update(' '.join('%s:%s'%v for v in headers.iteritems()))\n        md.update(path)\n\n        cache_file = os.path.join(CACHE_DIR, md.hexdigest())\n        if os.path.exists(cache_file):\n            o = json.load( open(cache_file+'.js', 'rb') )\n            start_response(o['response'], o['headers'])\n            return self.yieldData( open(cache_file) )\n",
    "language": "python",
    "cwe_identifier": "CWE-328",
    "pattern_desc": "The MD5 hash function is considered insecure. Avoid using it unless explicitly needed for compatibility reasons",
    "line_number": 59,
    "line_text": "        md = hashlib.md5()",
    "pattern_id": "PY-R-002",
    "rule": "\\bhashlib\\.md5\\(",
    "label": 1
}