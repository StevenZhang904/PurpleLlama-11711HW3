{
    "file_path": "trac/attachment.py",
    "vulnerability": null,
    "source code": "\n\n    @classmethod\n    def _get_path(cls, env_path, parent_realm, parent_id, filename):\n        \"\"\"Get the path of an attachment.\n\n        WARNING: This method is used by db28.py for moving attachments from\n        the old \"attachments\" directory to the \"files\" directory. Please check\n        all changes so that they don't break the upgrade.\n        \"\"\"\n        path = os.path.join(env_path, 'files', 'attachments',\n                            parent_realm)    @classmethod\n    def _get_path(cls, env_path, parent_realm, parent_id, filename):\n        \"\"\"Get the path of an attachment.\n\n        WARNING: This method is used by db28.py for moving attachments from\n        the old \"attachments\" directory to the \"files\" directory. Please check\n        all changes so that they don't break the upgrade.\n        \"\"\"\n        path = os.path.join(env_path, 'files', 'attachments',\n                            parent_realm)\n        hash = hashlib.sha1(parent_id.encode('utf-8')).hexdigest()\n        path = os.path.join(path, hash[0:3], hash)\n        if filename:\n            path = os.path.join(path, cls._get_hashed_filename(filename))\n        return os.path.normpath(path)\n\n    _extension_re = re.compile(r'\\.[A-Za-z0-9]+\\Z')\n\n    @classmethod\n    def _get_hashed_filename(cls, filename):",
    "language": "python",
    "cwe_identifier": "CWE-328",
    "pattern_desc": "The SHA1 hash function is considered insecure. Avoid using it unless explicitly needed for compatibility reasons",
    "line_number": 723,
    "line_text": "        hash = hashlib.sha1(parent_id.encode('utf-8')).hexdigest()",
    "pattern_id": "PY-R-004",
    "rule": "\\bhashlib\\.sha1\\(",
    "label": 1
}