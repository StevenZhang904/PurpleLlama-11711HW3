{
    "file_path": "contrib/wikipedia/src/de/zib/scalaris/examples/wikipedia/bliki/WikiServletScalaris.java",
    "vulnerability": null,
    "source code": "\n\n        public void run() {\n            InputSource[] is = null;\n            try {\n                handler.setUp();\n                if (handler instanceof WikiDumpHandler) {\n                    WikiDumpHandler xmlHandler = (WikiDumpHandler) handler;\n                    XMLReader reader = XMLReaderFactory.createXMLReader();\n                    reader.setContentHandler(xmlHandler);\n                    is = de.zib.scalaris.examples.wikipedia.data.xml.Main.getFileReader(fileName);\n                    for (InputSource source : is) {        public void run() {\n            InputSource[] is = null;\n            try {\n                handler.setUp();\n                if (handler instanceof WikiDumpHandler) {\n                    WikiDumpHandler xmlHandler = (WikiDumpHandler) handler;\n                    XMLReader reader = XMLReaderFactory.createXMLReader();\n                    reader.setContentHandler(xmlHandler);\n                    is = de.zib.scalaris.examples.wikipedia.data.xml.Main.getFileReader(fileName);\n                    for (InputSource source : is) {\n                        reader.parse(source);\n                    }\n                    xmlHandler.new ReportAtShutDown().reportAtEnd();\n                    ps.println(\"import finished\");\n                } else if (handler instanceof WikiDumpPreparedSQLiteToScalaris) {\n                    WikiDumpPreparedSQLiteToScalaris sqlHandler =\n                            (WikiDumpPreparedSQLiteToScalaris) handler;\n                    sqlHandler.writeToScalaris();\n                    sqlHandler.new ReportAtShutDown().reportAtEnd();\n                }",
    "language": "java",
    "cwe_identifier": "CWE-611",
    "pattern_desc": "External XML entities are a feature of XML parsers that allow documents to contain references\nto other documents or data. This feature can be abused to read files, communicate with external\nhosts, exfiltrate data, or cause a Denial of Service (DoS).\nThe XMLReaderFactory has been deprecated. It is recommended that\n[SAXParserFactory](https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html)\nbe used instead. Additionally when using the SAXParser it must be configured to disallow doctypes,\nwhich will protect against the majority of XXE attacks.\n",
    "line_number": 413,
    "line_text": "                        reader.parse(source);",
    "pattern_id": "security.genai.CybersecurityBenchmarks.insecure_code_detector.internal.rules.semgrep.java.third-party.xxe-deprecated-xml-reader",
    "rule": null,
    "label": 1
}